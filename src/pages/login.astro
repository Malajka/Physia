---
import { LoginForm } from "@/components/auth/LoginForm";
import { LinkButton } from "@/components/ui/LinkButton";
import Layout from "@/layouts/Layout.astro";

export const prerender = false;

// Determine if there's an error passed via query params
const error = Astro.url.searchParams.get("error");
const errorMessage = error === "invalid_credentials" ? "Invalid email or password" : error ? "An error occurred during login" : null;
---

<Layout title="Login - Physia">
  <div class="container mx-auto max-w-md p-4">
    <header class="mb-8 text-center">
      <a href="/" class="inline-block">
        <h1 class="text-3xl font-bold text-slate-700">Login to Physia</h1>
      </a>
    </header>

    <main class="bg-white rounded-lg shadow-md p-6 md:p-8">
      <LoginForm initialError={errorMessage} client:load />

      <div class="mt-6 text-center">
        <p class="text-gray-600 mb-2">Don't have an account?</p>
        <LinkButton href="/register" variant="secondary" client:load> Create Account </LinkButton>
      </div>
    </main>

    <footer class="mt-8 text-center text-sm text-slate-500">
      <p>&copy; {new Date().getFullYear()} Physia. All rights reserved.</p>
    </footer>
  </div>
</Layout>
