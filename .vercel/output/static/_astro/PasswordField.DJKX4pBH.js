import{J as m}from"./api.C6upV_NU.js";import"./auth.validator.Cf-Y9Meb.js";import{j as a}from"./jsx-runtime.BMmiHB9I.js";import{r as u}from"./index.Cj_FO6QK.js";import{E as h,S as x,I as g}from"./SubmitButton.D_2OGRIf.js";import"./LinkButton.BhR02P1x.js";async function f(r,o,n){try{const e=await fetch(r,{method:"POST",credentials:"include",headers:m,body:JSON.stringify(o)});if(!e.ok){const t=await e.json();let s=t.error||t.message||n;return t.code&&(s=`${s}|${t.code}`),{success:!1,error:s}}return{success:!0,error:""}}catch(e){return{success:!1,error:e instanceof Error?e.message:"An unexpected error occurred"}}}async function A(r){return f("/api/auth/login",r,"Login failed")}async function v(r){return f("/api/auth/register",r,"Registration failed")}function p(r,o=null){const[n,e]=u.useState(!1),[t,s]=u.useState(o),d=u.useCallback(async c=>{c.preventDefault(),e(!0),s(null);try{const i=new FormData(c.currentTarget),l=await r(i);l.success||s(l.error??null)}catch(i){i instanceof Error?s(i.message):s("An unexpected error occurred")}finally{e(!1)}},[r]);return{loading:n,errors:t,handleSubmit:d}}const F=function({title:o,onSubmit:n,children:e,submitText:t,errors:s=null,submitTestId:d}){const{loading:c,errors:i,handleSubmit:l}=p(n,s);return a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:o}),a.jsx(h,{errors:i}),a.jsxs("form",{onSubmit:l,"data-testid":"auth-form",noValidate:!0,children:[e,a.jsx("div",{className:"mt-6 flex justify-center",children:a.jsx(x,{loading:c,"data-testid":d,children:t})})]})]})};function N(r){const[o,n]=u.useState(!1),e=()=>{n(t=>!t)};return a.jsxs("div",{className:"relative",children:[a.jsx(g,{...r,type:o?"text":"password",forceShowError:r.forceShowError,"data-testid":r["data-testid"]}),a.jsx("button",{type:"button",tabIndex:-1,onClick:e,className:"absolute right-2 top-3/4 transform -translate-y-3/4 text-gray-500 hover:text-gray-700 text-xs","aria-label":o?"Hide password":"Show password",children:o?"Hide":"Show"})]})}export{F as A,N as P,A as l,v as r};
