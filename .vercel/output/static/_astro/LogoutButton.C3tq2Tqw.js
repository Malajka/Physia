import{j as u}from"./jsx-runtime.BMmiHB9I.js";import{B as i,c as l}from"./SubmitButton.D_2OGRIf.js";import{r as n}from"./index.Cj_FO6QK.js";import"./LinkButton.BhR02P1x.js";import{S as g}from"./Spinner.BIKKfVSC.js";import"./auth.validator.Cf-Y9Meb.js";import{J as m}from"./api.C6upV_NU.js";import"./index.DqldKjai.js";const f=async()=>{try{const o=await fetch("/api/auth/logout",{method:"POST",credentials:"include",headers:m});if(!o.ok){const r=await o.json();return{success:!1,error:r.error||r.message||`Logout failed (status: ${o.status})`}}return window.location.href="/login",{success:!0}}catch(o){return{success:!1,error:`Logout error: ${o instanceof Error?o.message:"Unknown error"}`}}},d=()=>{const[o,r]=n.useState(!1),[s,e]=n.useState(null),c=n.useCallback(async()=>{r(!0),e(null);try{const t=await f();!t.success&&t.error&&(e(t.error),window.alert(t.error))}catch(t){const a=t instanceof Error?t.message:"Unexpected error during logout";e(a),window.alert(a)}finally{r(!1)}},[]);return{isLoggingOut:o,error:s,logout:c}},y=function({className:r=""}){const{isLoggingOut:s,logout:e}=d();return u.jsxs(i,{variant:"ghost",size:"default",onClick:e,disabled:s,"aria-busy":s,className:l(r),"data-testid":"logout-button",children:[s?u.jsx(g,{className:"h-4 w-4"}):null,s?"Logging out...":"Log out"]})};export{y as LogoutButton};
